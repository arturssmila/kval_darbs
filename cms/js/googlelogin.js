var popupManager={};popupManager.constants={darkCover:"popupManager_darkCover_div",darkCoverStyle:["position:absolute;","top:0px;","left:0px;","padding-right:0px;","padding-bottom:0px;","background-color:#000000;","opacity:0.5;","-moz-opacity:0.5;","filter:alpha(opacity=0.5);","z-index:10000;","width:100%;","height:100%;"].join(""),openidSpec:{identifier_select:"http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select",namespace2:"http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0"}};popupManager.getWindowInnerSize=function(){var e=0;var t=0;var n=null;if("innerWidth"in window){e=window.innerWidth;t=window.innerHeight}else{if("BackCompat"===window.document.compatMode&&"body"in window.document){n=window.document.body}else if("documentElement"in window.document){n=window.document.documentElement}if(n!==null){e=n.offsetWidth;t=n.offsetHeight}}return[e,t]};popupManager.getParentCoords=function(){var e=0;var t=0;if("screenLeft"in window){e=window.screenLeft;t=window.screenTop}else if("screenX"in window){e=window.screenX;t=window.screenY}return[e,t]};popupManager.getCenteredCoords=function(e,t){var n=this.getWindowInnerSize();var r=this.getParentCoords();var i=r[0]+Math.max(0,Math.floor((n[0]-e)/2));var s=r[1]+Math.max(0,Math.floor((n[1]-t)/2));return[i,s]};popupManager.darkenScreen=function(){var e=window.document.getElementById(window.popupManager.constants["darkCover"]);if(!e){e=window.document.createElement("div");e["id"]=window.popupManager.constants["darkCover"];e.setAttribute("style",window.popupManager.constants["darkCoverStyle"]);window.document.body.appendChild(e)}e.style.visibility="visible"};popupManager.createPopupOpener=function(e){var t=null;var n=null;var r=this;var i="shouldEncodeUrls"in e?e.shouldEncodeUrls:true;var s=function(e){return i?encodeURIComponent(e):e};var o="identifier"in e?s(e.identifier):this.constants.openidSpec.identifier_select;var u="identity"in e?s(e.identity):this.constants.openidSpec.identifier_select;var a="namespace"in e?s(e.namespace):this.constants.openidSpec.namespace2;var f="onOpenHandler"in e&&"function"===typeof e.onOpenHandler?e.onOpenHandler:this.darkenScreen;var l="onCloseHandler"in e&&"function"===typeof e.onCloseHandler?e.onCloseHandler:null;var c="returnToUrl"in e?e.returnToUrl:null;var h="realm"in e?e.realm:null;var p="opEndpoint"in e?e.opEndpoint:null;var d="extensions"in e?e.extensions:null;var v=function(e){var t="";for(key in e){t+=["&",key,"=",s(e[key])].join("")}return t};var m=function(){var e="&";var t=null;var n=null;if(null===p||null===c){return}if(p.indexOf("?")===-1){e="?"}t=s(c);n=[p,e,"openid.ns=",a,"&openid.mode=checkid_setup","&openid.claimed_id=",o,"&openid.identity=",u,"&openid.return_to=",t].join("");if(h!==null){n+="&openid.realm="+s(h)}if(d!==null){n+=v(d)}n+="&openid.ns.ui="+encodeURIComponent("http://specs.openid.net/extensions/ui/1.0");n+="&openid.ui.mode=popup";return n};var g=function(){return!n||n.closed};var y=function(){if(g()){n=null;var e=window.document.getElementById(window.popupManager.constants["darkCover"]);if(e){e.style.visibility="hidden"}if(l!==null){l()}if(null!==t){window.clearInterval(t);t=null}}};return{popup:function(e,i){var s=m();if(f!==null){f()}var o=r.getCenteredCoords(e,i);n=window.open(s,"","width="+e+",height="+i+",status=1,location=1,resizable=yes"+",left="+o[0]+",top="+o[1]);t=window.setInterval(y,80);return true}}}